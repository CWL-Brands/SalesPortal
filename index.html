<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanva Botanicals Quote Calculator</title>
    
    <!-- Tailwind CSS CDN with custom configuration -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Custom Tailwind configuration for Kanva branding
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'kanva': {
                            'green': '#93D500',
                            'dark': '#17351A',
                            'light': '#f8fdf8',
                            'accent': '#e8f5e8'
                        }
                    },
                    borderWidth: {
                        '3': '3px'
                    },
                    backdropBlur: {
                        'xs': '2px'
                    }
                }
            }
        }
    </script>
    
    <!-- Copper SDK - Load first for CRM integration -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/copper-sdk@latest/dist/copper-sdk.min.js"></script>
    
    <!-- SIMPLIFIED CSS - Only keep essential custom styles -->
    <style>
        /* Only keep styles that Tailwind can't handle */
        
        /* Custom animations */
        @keyframes kanva-pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.8; }
        }
        
        @keyframes kanva-spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .kanva-pulse { animation: kanva-pulse 2s infinite; }
        .kanva-spin { animation: kanva-spin 1s linear infinite; }
        
        /* Custom gradients that extend Tailwind */
        .bg-kanva-gradient {
            background: linear-gradient(135deg, #93D500 0%, #7ab300 100%);
        }
        
        .bg-kanva-gradient-hover:hover {
            background: linear-gradient(135deg, #7ab300 0%, #93D500 100%);
        }
        
        /* Loading animation */
        .loading-dots::after {
            content: '';
            animation: kanva-pulse 1.5s infinite;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans">
    <!-- Main Application Container with Tailwind classes -->
    <div id="app" class="min-h-screen">
        <!-- Loading state with Tailwind -->
        <div class="flex items-center justify-center min-h-screen bg-gradient-to-br from-kanva-light to-kanva-accent">
            <div class="text-center p-8">
                <div class="text-4xl mb-4 kanva-pulse">ðŸŒ¿</div>
                <div class="text-xl font-bold text-kanva-dark">Loading Kanva Calculator<span class="loading-dots">...</span></div>
                <div class="mt-4 w-32 h-1 bg-kanva-green rounded-full mx-auto">
                    <div class="h-full bg-kanva-dark rounded-full kanva-spin origin-left" style="width: 30%;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript Files - Critical loading order! -->
    
    <!-- 1. Core configuration and utilities -->
    <script src="js/config.js"></script>
    
    <!-- 2. Notification system (must load before other modules that use it) -->
    <script src="js/notification-manager.js"></script>
    
    <!-- 3. Missing functions (must load before modules that reference them) -->
    <script src="js/missing-functions.js"></script>
    
    <!-- 4. Core calculation engine -->
    <script src="js/calculator.js"></script>
    
    <!-- 5. Admin panel functionality -->
    <script src="js/admin.js"></script>
    
    <!-- 6. CRM integration -->
    <script src="js/copper-integration.js"></script>
    
    <!-- 7. Email generation -->
    <script src="js/email-generator.js"></script>
    
    <!-- 8. Main application orchestrator (must load last) -->
    <script src="js/main.js"></script>
    
    <!-- Global error handling -->
    <script>
        // Global error handler for debugging
        window.addEventListener('error', function(event) {
            console.error('ðŸ’¥ Global JavaScript Error:', {
                message: event.message,
                filename: event.filename,
                lineno: event.lineno,
                colno: event.colno,
                error: event.error
            });
            
            // Show user-friendly error if NotificationManager is available
            if (typeof NotificationManager !== 'undefined') {
                NotificationManager.showError(
                    'A technical error occurred. Please refresh the page or contact support if the problem persists.',
                    'Application Error'
                );
            }
        });
        
        // Unhandled promise rejection handler
        window.addEventListener('unhandledrejection', function(event) {
            console.error('ðŸ’¥ Unhandled Promise Rejection:', event.reason);
            
            if (typeof NotificationManager !== 'undefined') {
                NotificationManager.showError(
                    'A network or data error occurred. Please try again.',
                    'Connection Error'
                );
            }
        });
        
        // Log when app is fully loaded
        window.addEventListener('load', function() {
            console.log('ðŸš€ Kanva Calculator fully loaded and ready');
        });
    </script>
</body>
</html>
