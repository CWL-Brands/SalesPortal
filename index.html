<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanva Botanicals Quote Calculator</title>
    
    <!-- Copper SDK - Load first for CRM integration -->
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/copper-sdk@latest/dist/copper-sdk.min.js"></script>
    
    <!-- CSS Files - Order matters for proper cascading -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/hybrid.css">
</head>
<body>
    <!-- Main Application Container -->
    <div id="app">
        <!-- App content will be dynamically generated by main.js -->
        <div class="loading">
            <div>ðŸŒ¿ Loading Kanva Calculator...</div>
        </div>
    </div>

    <!-- JavaScript Files - Critical loading order! -->
    
    <!-- 1. Core configuration and utilities -->
    <script src="js/config.js"></script>
    
    <!-- 2. Notification system (must load before other modules that use it) -->
    <script src="js/notification-manager.js"></script>
    
    <!-- 3. Missing functions (must load before modules that reference them) -->
    <script src="js/missing-functions.js"></script>
    
    <!-- 4. Core calculation engine -->
    <script src="js/calculator.js"></script>
    
    <!-- 5. Admin panel functionality -->
    <script src="js/admin.js"></script>
    
    <!-- 6. CRM integration -->
    <script src="js/copper-integration.js"></script>
    
    <!-- 7. Email generation -->
    <script src="js/email-generator.js"></script>
    
    <!-- 8. Main application orchestrator (must load last) -->
    <script src="js/main.js"></script>

    <!-- Global error handling -->
    <script>
        // Global error handler for debugging
        window.addEventListener('error', function(event) {
            console.error('ðŸ’¥ Global JavaScript Error:', {
                message: event.message,
                filename: event.filename,
                lineno: event.lineno,
                colno: event.colno,
                error: event.error
            });
            
            // Show user-friendly error if NotificationManager is available
            if (typeof NotificationManager !== 'undefined') {
                NotificationManager.showError(
                    'A technical error occurred. Please refresh the page or contact support if the problem persists.',
                    'Application Error'
                );
            }
        });

        // Unhandled promise rejection handler
        window.addEventListener('unhandledrejection', function(event) {
            console.error('ðŸ’¥ Unhandled Promise Rejection:', event.reason);
            
            if (typeof NotificationManager !== 'undefined') {
                NotificationManager.showError(
                    'A network or data error occurred. Please try again.',
                    'Connection Error'
                );
            }
        });

        // Log when app is fully loaded
        window.addEventListener('load', function() {
            console.log('ðŸš€ Kanva Calculator fully loaded and ready');
        });
    </script>
</body>
</html>
